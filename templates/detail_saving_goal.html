<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Chi tiáº¿t má»¥c tiÃªu tiáº¿t kiá»‡m</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/detail_saving_goal.css') }}">
</head>
<body>
  <header>
    <div class="header">
      <span class="back-btn" onclick="window.location.href = '/home_saving_goal';">â†</span>
      <h2>Chi tiáº¿t má»¥c tiÃªu tiáº¿t kiá»‡m</h2>
      {% if goals %}
      <button class="edit-btn" onclick="openEditForm('{{ goals[0].goal_id }}')">âœ</button>
      {% endif %}
      </div>
  </header>

  <ul>
    {% for item in goals_with_progress %}
      <li>
        <div class="goal-box" data-goal-id="{{ item.goal.goal_id }}">
          <strong>{{ item.goal.name }}</strong><br>
          ğŸ¯ Sá»‘ tiá»n má»¥c tiÃªu: {{ "{:,.0f}".format(item.goal.target_amount) }} Ä‘<br>
          â³ Thá»i gian: {{ item.goal.start_time.strftime('%d/%m/%Y') }} â†’ {{ item.goal.end_time.strftime('%d/%m/%Y') }}<br>
          {% if item.goal.note %}ğŸ“ Ghi chÃº: {{ item.goal.note }}{% endif %}
          <p>ÄÃ£ náº¡p: {{ "{:,.0f}".format(item.total_deposited) }} / {{ "{:,.0f}".format(item.goal.target_amount) }} Ä‘</p>
          <p>Tiáº¿n Ä‘á»™: {{ item.completion_percentage|round(2) }}%</p>
          
          <div class="goal-actions">
            <button class="deposit-btn" onclick="window.location.href='/deposit?goal_id={{ item.goal.goal_id }}'">Náº¡p tiá»n</button>
            <button class="update-btn" onclick="openEditForm('{{ item.goal.goal_id }}')">Chá»‰nh sá»­a</button>
          </div>
          <hr>
        </div>
      </li>
    {% else %}
      <li>KhÃ´ng cÃ³ má»¥c tiÃªu nÃ o.</li>
    {% endfor %}
  </ul>

  <!-- Edit Modal -->
  <div id="edit-form" class="modal hidden">
    <div class="modal-content">
      <form id="edit-goal-form">
        <h2 id="form-title">Chá»‰nh sá»­a má»¥c tiÃªu</h2>
        
        <div class="form-row">
          <div class="input-container">
            <i class="fas fa-mountain"></i>
            <label for="edit-name">TÃªn má»¥c tiÃªu</label>
          </div>
          <input type="text" id="edit-name" name="name" placeholder="TÃªn má»¥c tiÃªu" required maxlength="50">
        </div>

        <div class="form-row">
          <div class="input-container">
            <i class="fas fa-dollar-sign money-icon"></i>
            <label for="edit-target-amount">Sá»‘ tiá»n má»¥c tiÃªu (Ä‘)</label>
          </div>
          <input type="number" id="edit-target-amount" name="target_amount" 
                 placeholder="Vui lÃ²ng nháº­p sá»‘ tiá»n" required min="1000" step="1000">
        </div>

        <div class="form-row">
          <div class="input-container">
            <i class="fas fa-calendar-alt calendar-icon"></i>
            <label for="edit-start-time">Khá»Ÿi Ä‘áº§u</label>
          </div>
          <input type="date" id="edit-start-time" name="start_time" required>
        </div>

        <div class="form-row">
          <div class="input-container">
            <i class="fas fa-calendar-alt calendar-icon"></i>
            <label for="edit-end-time">Káº¿t thÃºc</label>
          </div>
          <input type="date" id="edit-end-time" name="end_time" required>
        </div>

        <div class="form-row">
          <div class="input-container">
            <i class="fas fa-book"></i>
            <label for="edit-note">Ghi chÃº</label>
          </div>
          <textarea id="edit-note" name="note" maxlength="200" 
                    placeholder="Vui lÃ²ng Ä‘iá»n ghi chÃº cá»§a má»¥c tiÃªu (tá»‘i Ä‘a 200 kÃ½ tá»±)"></textarea>
        </div>

        <div class="form-actions">
          <button type="submit" class="save-btn">LÆ°u</button>
          <button type="button" class="cancel-btn" onclick="hideEditForm()">Há»§y</button>
          <button type="button" class="delete-btn" onclick="confirmDelete()">XÃ³a</button>
        </div>
      </form>
    </div>
  </div>

  <script src="{{ url_for('static', filename='js/detail_saving_goal.js') }}"></script>
</body>
</html>